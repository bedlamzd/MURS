%! Author = bedlamzd
%! Date = 28.02.2021

% Preamble
\documentclass[14pt]{extarticle}

\include{preamble}

% Document
\begin{document}
    \include{title_page}

    \section*{Дано}

    \section*{Задание}
    Решить обратную задачу кинематики для шестизвенного манипулятора с помощью метода кинематического декомпозирования.
    \begin{enumerate}
        \item Рассчитать координаты точки пересечения осей вращений сочленений сферического запястья
        \item Решить обратную задачу кинематики по положению
        \item Решить обратную задачу кинематики по ориентации
    \end{enumerate}

    \section*{Решение}
    Системы координат выбраны как показано на рисунке~\ref{pic:frames}
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.75\textwidth]{frames.png}
        \caption{Системы координат звеньев манипулятора}
        \label{pic:frames}
    \end{figure}

    Параметры Денавита-Хартенберга приведены в таблице~\ref{tbl:params}.
    Значения параметров $a_i,\ d_i$ были приняты единычными. Поскольку все звенья манипулятора
    вращательные, то углы $\theta_i$ выступают в качестве обобщённых координат и будут выбраны произвольно.
    {
    \renewcommand{\arraystretch}{2}
    \begin{table}[H]
        \centering
        \begin{tabular}{*{5}{c}}\toprule
            Звено, $i$  & $a_i$ & $\alpha_i$        & $d_i$ & $\theta_i$ \\ [1ex] \midrule
            1           & 0     & $\dfrac{\pi}{2}$  & $d_1$ & $\theta_1$ \\ [1ex] \midrule
            2           & $a_2$ & 0                 & 0     & $\theta_2$ \\ [1ex] \midrule
            3           & 0     & $\dfrac{\pi}{2}$  & 0     & $\theta_3 + \dfrac{\pi}{2}$ \\ [1ex] \midrule
            4           & 0     & $-\dfrac{\pi}{2}$ & $d_4$ & $\theta_4$ \\ [1ex] \midrule
            5           & 0     & $\dfrac{\pi}{2}$  & 0     & $\theta_5$ \\ [1ex] \midrule
            6           & 0     & 0                 & $d_6$ & $\theta_6$ \\ [1ex]
            \bottomrule
        \end{tabular}
        \caption{Параметры Денавита-Хартенберга}
        \label{tbl:params}
    \end{table}
    }

    В приложении~\ref{code:ik} приведена функция для решения обратной задачи кинематики. В нём задаются параметры
    манипулятора и производится расчёт.

    Метод декомпозиции заключается в разделении ОЗК на два этапа:
    \begin{enumerate}
        \item ОЗК по положению
        \item ОЗК по ориентации
    \end{enumerate}

    Зная вектор $p^0_6$ и матрицу $R^0_6$ можно посчитать вектор $p^0_4$

    \begin{equation}
        p^0_4 = p^0_6 - d_6 R^0_6
        \begin{bmatrix}
            0 \\
            0 \\
            1
        \end{bmatrix}
    \end{equation}

    После этого производится расчёт положений первых трёх звеньев исходя из положения четвёртого звена и параметров Денавита-Хартенберга.

    Затем для определения матрицы $T_{03}$ и получения из неё матрицы поворота $R_{03}$ решается прямая задача кинематики для первых трёх звеньев.

    Зная матрицы поворта $R_{03}$ и $R_{06}$ находим $R_{36}$, которая необходима для решения ОЗК по ориентации для углов
    $q_4 \dots q_6$.

    Проверим полученную функцию сначала решив ПЗК и используем её результаты для решения ОЗК.
    \begin{matlabcode*}{frame=single, xleftmargin=\parindent}
        >> fk([0.28 0.2 0.1 0.9 0.9 0.9])

        ans =

            2.4620    0.0695    2.1431   -0.6581    0.8647   -0.8527

        >> ik([2.4620    0.0695    2.1431   -0.6581    0.8647   -0.8527])

        ans =

            0.2800    0.2000    0.1001    0.9001    0.9000    0.8999
    \end{matlabcode*}

    Получили изначальные величины, что доказывает правильность реализации.

    \section*{Вывод}
    В ходе работы написана функция решения обратной задачи кинематики.

    \appendix
    \renewcommand{\thesection}{\Asbuk{section}}
    \section{Функция решения прямой задачи кинематики}\label{code:ik}
    \octavefile[frame=single]{../src/ik.m}

\end{document}
